{
  "name": "Parrator Windows Dev Container",
  "build": {
    "dockerfile": "Dockerfile",
    "context": ".."
  },
  "remoteUser": "ContainerUser",
  "postCreateCommand": "pwsh -NoLogo -Command \"poetry install --with dev,textrefinement,funasr\"",
  "postStartCommand": "pwsh -NoLogo -Command \"& C:/app/scripts/start-dev-services.ps1\"",
  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-python.poetry",
        "ms-python.debugpy",
        "ms-python.black-formatter",
        "ms-python.isort",
        "ms-python.ruff",
        "ms-python.mypy-type-checker",
        "ms-vscode.powershell",
        "ms-vscode.vscode-json",
        "redhat.vscode-yaml",
        "ms-toolsai.jupyter",
        "ms-toolsai.jupyter-renderers",
        "ms-vscode-remote.remote-containers",
        "ms-vscode.remote-explorer",
        "formulahendry.code-runner",
        "streetsidesoftware.code-spell-checker",
        "bradlc.vscode-tailwindcss",
        "esbenp.prettier-vscode",
        "ms-vscode.hexeditor",
        "ms-vscode.cpptools",
        "ms-vscode.cmake-tools",
        "ms-vscode.makefile-tools",
        "ms-vscode.perl",
        "ms-vscode.node-azure-pack",
        "ms-vscode.azure-account",
        "ms-vscode.azurecli",
        "ms-vscode.docker",
        "ms-azuretools.vscode-docker"
      ],
      "settings": {
        "python.defaultInterpreterPath": "C:\\Python311\\python.exe",
        "python.terminal.activateEnvironment": false,
        "python.linting.enabled": true,
        "python.linting.ruffEnabled": true,
        "python.linting.mypyEnabled": true,
        "python.formatting.provider": "black",
        "python.formatting.blackArgs": ["--line-length", "88"],
        "python.sortImports.args": ["--profile", "black"],
        "editor.formatOnSave": true,
        "editor.codeActionsOnSave": {
          "source.organizeImports": true
        },
        "files.associations": {
          "*.py": "python",
          "*.ps1": "powershell",
          "*.json": "json",
          "*.yml": "yaml",
          "*.yaml": "yaml"
        },
        "powershell.startAutomatically": false,
        "powershell.integratedConsole.showOnStartup": false,
        "jupyter.askForKernelRestart": false,
        "jupyter.allowUnauthorizedRemoteAccess": true,
        "docker.showStartPage": false,
        "remote.SSH.showLoginDialog": false,
        "terminal.integrated.shell.windows": "pwsh.exe"
      }
    }
  },
  "forwardPorts": [5005, 8000, 8888, 6006],
  "portsAttributes": {
    "5005": {
      "label": "Inference Server",
      "onAutoForward": "notify"
    },
    "8000": {
      "label": "VS Code Server",
      "onAutoForward": "notify"
    },
    "8888": {
      "label": "Jupyter Lab",
      "onAutoForward": "notify"
    },
    "6006": {
      "label": "TensorBoard",
      "onAutoForward": "notify"
    }
  },
  "mounts": [
    "source=${localWorkspaceFolder}/models,target=C:\\app\\models,type=bind",
    "source=${localWorkspaceFolder}/audio,target=C:\\app\\audio,type=bind",
    "source=${localWorkspaceFolder}/logs,target=C:\\app\\logs,type=bind"
  ],
  "runArgs": [
    "--isolation=process",
    "--device=class://GPU",
    "--hostname=parrator-dev"
  ],
  "workspaceFolder": "C:\\app",
  "remoteEnv": {
    "PYTHONPATH": "C:\\app",
    "MODELS_PATH": "C:\\app\\models",
    "LOGS_PATH": "C:\\app\\logs",
    "AUDIO_PATH": "C:\\app\\audio",
    "INFERENCE_SERVER_HOST": "localhost",
    "INFERENCE_SERVER_PORT": "5005",
    "JUPYTER_HOST": "localhost",
    "JUPYTER_PORT": "8888"
  }
}
